(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{15:function(e,t,c){e.exports={gameOverlay:"GameOverlay_gameOverlay__11lfk",counter:"GameOverlay_counter__10t_X",count:"GameOverlay_count__1Jwug",finishedOverlay:"GameOverlay_finishedOverlay__3Uj9q",saveScoreForm:"GameOverlay_saveScoreForm__GTFwf",formDesc:"GameOverlay_formDesc__1NZAk",formInput:"GameOverlay_formInput__GN6kZ",error:"GameOverlay_error__CxX68",lds_dual_ring:"GameOverlay_lds_dual_ring__Z7iuB","lds-dual-ring":"GameOverlay_lds-dual-ring__1TG8e",topScorer:"GameOverlay_topScorer__1nlm3",leaderboardButton:"GameOverlay_leaderboardButton__2awEM",leaderboardModal:"GameOverlay_leaderboardModal__osw0N",closeButton:"GameOverlay_closeButton__2yy3U",leadersList:"GameOverlay_leadersList__2XUML",leadersItem:"GameOverlay_leadersItem__3UTzu"}},53:function(e,t,c){},56:function(e,t,c){},57:function(e,t,c){},58:function(e,t,c){"use strict";c.r(t);var s,r=c(7),n=c(39),a=c.n(n),i=c(20),o=c(13),l=c(9),u=c(14),j=c(35),d=c(5),b=Object(u.a)(Array(21).keys()),O=function(e){var t=e.setScore,c=void 0===t?function(){}:t,s=Object(r.useState)([]),n=Object(l.a)(s,2),a=n[0],i=n[1];Object(r.useEffect)((function(){var e=Object(j.sampleSize)(b,3);i(e)}),[]);var o=Object(r.useCallback)((function(e){var t=e.position,s=e.id;return Object(d.jsxs)("mesh",{onClick:function(e){var t=e.object.sphereId,s=Object(u.a)(a).filter((function(e){return e!==t})),r=Object(j.remove)(Object(u.a)(b),(function(e){return!a.includes(e)})),n=Object(j.sample)(r);i([].concat(Object(u.a)(s),[n])),c((function(e){return e+1}))},sphereId:s,position:t,children:[Object(d.jsx)("sphereGeometry",{args:[1,32,32]}),Object(d.jsx)("meshPhysicalMaterial",{color:"red"})]})}),[a]);return Object(d.jsxs)("group",{position:[0,0,-9],children:[a.includes(0)&&Object(d.jsx)(o,{id:0,position:[9,1,0]}),a.includes(1)&&Object(d.jsx)(o,{id:1,position:[6,1,0]}),a.includes(2)&&Object(d.jsx)(o,{id:2,position:[3,1,0]}),a.includes(3)&&Object(d.jsx)(o,{id:3,position:[0,1,0]}),a.includes(4)&&Object(d.jsx)(o,{id:4,position:[-3,1,0]}),a.includes(5)&&Object(d.jsx)(o,{id:5,position:[-6,1,0]}),a.includes(6)&&Object(d.jsx)(o,{id:6,position:[-9,1,0]}),a.includes(7)&&Object(d.jsx)(o,{id:7,position:[9,4,0]}),a.includes(8)&&Object(d.jsx)(o,{id:8,position:[6,4,0]}),a.includes(9)&&Object(d.jsx)(o,{id:9,position:[3,4,0]}),a.includes(10)&&Object(d.jsx)(o,{id:10,position:[0,4,0]}),a.includes(11)&&Object(d.jsx)(o,{id:11,position:[-3,4,0]}),a.includes(12)&&Object(d.jsx)(o,{id:12,position:[-6,4,0]}),a.includes(13)&&Object(d.jsx)(o,{id:13,position:[-9,4,0]}),a.includes(14)&&Object(d.jsx)(o,{id:14,position:[9,7,0]}),a.includes(15)&&Object(d.jsx)(o,{id:15,position:[6,7,0]}),a.includes(16)&&Object(d.jsx)(o,{id:16,position:[3,7,0]}),a.includes(17)&&Object(d.jsx)(o,{id:17,position:[0,7,0]}),a.includes(18)&&Object(d.jsx)(o,{id:18,position:[-3,7,0]}),a.includes(19)&&Object(d.jsx)(o,{id:19,position:[-6,7,0]}),a.includes(20)&&Object(d.jsx)(o,{id:20,position:[-9,7,0]})]})},m=c(61),v=Object(r.createContext)(),x="NOT_STARTED",f="START_TIMER",p="STARTED",h="FINISHED",S=10,y=5,_=75,g=0,N=function(e){var t=e.children,c=Object(r.useState)(60),n=Object(l.a)(c,2),a=n[0],i=n[1],o=Object(r.useState)(x),u=Object(l.a)(o,2),j=u[0],b=u[1],O=Object(r.useState)(0),S=Object(l.a)(O,2),y=S[0],N=S[1],k=Object(r.useState)(0),C=Object(l.a)(k,2),G=C[0],I=C[1],T=Object(r.useState)(0),E=Object(l.a)(T,2),w=E[0],L=E[1],B=Object(r.useState)(_),M=Object(l.a)(B,2),z=M[0],A=M[1],D=Object(r.useState)(g),F=Object(l.a)(D,2),R=F[0],J=F[1],P=Object(r.useState)(!1),U=Object(l.a)(P,2),X=U[0],Z=U[1],q=Object(r.useState)(),H=Object(l.a)(q,2),V=H[0],Y=H[1],$=function(){m.a.get("https://us-central1-gridshot-bbd16.cloudfunctions.net/getTopScores").then((function(e){e.data&&e.data.users&&Y(e.data.users)}))};return Object(r.useEffect)((function(){var e=localStorage.getItem("topScore"),t=localStorage.getItem("sensitivity"),c=localStorage.getItem("fov"),s=localStorage.getItem("scoreSaved");e&&L(JSON.parse(e)),c&&A(JSON.parse(c)),t&&J(JSON.parse(t)),s&&Z(JSON.parse(s)),$()}),[]),Object(r.useEffect)((function(){localStorage.setItem("sensitivity",R),localStorage.setItem("fov",z)}),[R,z]),Object(r.useEffect)((function(){localStorage.setItem("scoreSaved",X)}),[X]),Object(r.useEffect)((function(){j===f&&(s=setInterval((function(){i((function(e){return e>1?e-1:(clearInterval(s),b(h),0)}))}),1e3),b(p)),j===h&&clearInterval(s)}),[j]),Object(d.jsx)(v.Provider,{value:{timeLeft:a,setTimeLeft:i,score:y,setScore:N,gameStart:j,setGameStart:b,totalClicks:G,setTotalClicks:I,topScore:w,setTopScore:L,fov:z,setFov:A,sensitivity:R,setSensitivity:J,scoreSaved:X,setScoreSaved:Z,leaderboard:V,getScores:$},children:t})},k=(c(53),c(62)),C=[0,0,0],G=Object(r.forwardRef)((function(e,t){var c=1+.1*e.sensitivity;return Object(i.b)((function(){if(t.current.camera.fov=e.fov,t.current.camera.updateProjectionMatrix(),0===t.current.camera.rotation.x&&0===t.current.camera.rotation.y&&0===t.current.camera.rotation.z)C=[0,0,0];else{var s={x:C[0]-t.current.camera.rotation.x,y:C[1]-t.current.camera.rotation.y,z:C[2]-t.current.camera.rotation.z},r=[t.current.camera.rotation.x-s.x*c,t.current.camera.rotation.y-s.y*c,t.current.camera.rotation.z-s.z*c];t.current.camera.rotation.set(r[0],r[1],r[2]),C[0]=t.current.camera.rotation.x,C[1]=t.current.camera.rotation.y,C[2]=t.current.camera.rotation.z}})),Object(d.jsx)(k.a,{selector:"#startButton",ref:t})})),I=Object(r.memo)((function(){var e=Object(r.useRef)(),t=Object(r.useContext)(v),c=t.gameStart,s=t.setGameStart,n=t.setTimeLeft,a=t.setScore,l=t.setTotalClicks,u=t.sensitivity,j=t.fov;Object(r.useEffect)((function(){}),[e]),Object(r.useEffect)((function(){c===h&&e.current.unlock()}),[c]);return Object(d.jsxs)(i.a,{onCreated:function(t){var c=document.querySelector("#cursor"),r=document.querySelector("#startOverlay");e.current.addEventListener("lock",(function(){document.body.style.cursor="none",c.style.display="initial",r.style.display="none",n(60),s(f),a(0),l(0)})),e.current.addEventListener("unlock",(function(){document.body.style.cursor="initial",c.style.display="none",r.style.display="block",e.current&&e.current.camera&&e.current.camera.rotation.set(0,0,0),s(h)})),e.current.addEventListener("change",(function(t){var c=new o.Vector3;e.current.getDirection(c)}))},children:[Object(d.jsx)("pointLight",{castShadow:!0,color:"#fff",position:[0,4,10],intensity:2}),Object(d.jsx)("ambientLight",{intensity:1}),Object(d.jsx)(O,{setScore:a}),Object(d.jsxs)("mesh",{scale:[20,10,18],position:[0,4,0],children:[Object(d.jsx)("boxGeometry",{}),Object(d.jsx)("meshPhysicalMaterial",{metalness:.7,roughness:2,color:"#fff",side:o.DoubleSide})]}),Object(d.jsx)(G,{fov:j,sensitivity:u,ref:e})]})})),T=function(){var e=Object(r.useRef)(),t=function(t){e.current&&(e.current.style.left="".concat(t.clientX,"px"),e.current.style.top="".concat(t.clientY,"px"))};return Object(r.useEffect)((function(){return document.body.addEventListener("mousemove",t),function(){return document.body.removeEventListener("mousemove",t)}}),[]),Object(d.jsx)("span",{ref:e,id:"cursor",className:"cursor"})},E=c(17),w=c.n(E),L=c(34),B=c(15),M=c.n(B),z=/^(?=[a-zA-Z0-9._]{3,20}$)(?!.*[_.]{2})[^_.].*[^_.]$/,A=function(){var e=Object(r.useContext)(v),t=e.timeLeft,c=e.score,s=e.totalClicks,n=e.gameStart,a=e.topScore,i=e.setTopScore,o=e.scoreSaved,u=e.setScoreSaved,j=e.leaderboard,b=e.getScores,O=Object(r.useState)(""),f=Object(l.a)(O,2),p=f[0],_=f[1],g=Object(r.useState)(""),N=Object(l.a)(g,2),k=N[0],C=N[1],G=Object(r.useState)(!1),I=Object(l.a)(G,2),T=I[0],E=I[1],B=Object(r.useState)(!1),A=Object(l.a)(B,2),D=A[0],F=A[1],R=function(){return c*S-(s-c)*y},J=n===h||n===x,P=R(),U=s-c,X=(c/s*100).toFixed(2),Z=n===h&&!o&&a,q=j&&j[0];Object(r.useEffect)((function(){if(n===h){var e=R();e>a&&(i(e),u(!1),localStorage.setItem("topScore",e))}}),[n]);var H=function(){var e=Object(L.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k&&z.test(k)){e.next=4;break}_("Please enter a valid username. Alpha-numeric between 3-20 characters"),e.next=17;break;case 4:return e.prev=4,E(!0),e.next=8,m.a.post("https://us-central1-gridshot-bbd16.cloudfunctions.net/addScore",{user:{username:k,score:Number(a)}});case 8:t=e.sent,E(!1),200===t.status&&(u(!0),b()),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(4),E(!1),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{class:M.a.gameOverlay,children:[Object(d.jsxs)("div",{className:M.a.counter,children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{style:{fontSize:"20px"},children:"Time left:"}),Object(d.jsx)("span",{style:{color:"red"},className:M.a.count,children:t})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{children:"Current score:"}),Object(d.jsx)("span",{className:M.a.count,children:P})]})]}),q&&Object(d.jsxs)("div",{className:M.a.topScorer,children:[Object(d.jsx)("div",{children:"Top Scorer"}),Object(d.jsxs)("div",{children:[q.username," : ",q.score]}),Object(d.jsx)("div",{className:M.a.leaderboardButton,onClick:function(){return F(!0)},children:"See leaderboard"})]}),J&&Object(d.jsxs)("div",{className:M.a.finishedOverlay,children:[Object(d.jsxs)("span",{children:["Score: ",P]}),Object(d.jsxs)("span",{children:["Hits: ",c]}),Object(d.jsxs)("span",{children:["Total Clicks: ",s]}),Object(d.jsxs)("span",{children:["Misses: ",U]}),Object(d.jsxs)("span",{children:["Accuracy: ",isNaN(X)?"N/A":"".concat(X,"%")]}),Object(d.jsxs)("span",{children:["Best Score: ",a]})]}),Z&&Object(d.jsxs)("div",{className:M.a.saveScoreForm,children:[Object(d.jsx)("span",{className:M.a.formDesc,children:"Save your top score on the leaderboards."}),Object(d.jsxs)("span",{className:M.a.formInput,children:["Enter name:"," ",Object(d.jsx)("input",{type:"text",value:k,onChange:function(e){C(e.target.value)}}),T&&Object(d.jsx)("div",{className:M.a.lds_dual_ring})]}),Object(d.jsx)("span",{className:M.a.error,style:{display:p?"inline":"none"},children:p}),Object(d.jsx)("button",{disabled:T,onClick:H,children:"Submit"})]}),D&&Object(d.jsxs)("div",{className:M.a.leaderboardModal,children:[Object(d.jsx)("div",{className:M.a.closeButton,onClick:function(){return F(!1)},children:"close"}),Object(d.jsxs)("div",{className:M.a.leadersList,children:[Object(d.jsxs)("div",{className:M.a.leadersItem,children:[Object(d.jsx)("span",{children:"Name"}),Object(d.jsx)("span",{children:"Score"})]}),j&&j.map((function(e,t){return Object(d.jsxs)("div",{className:M.a.leadersItem,children:[Object(d.jsxs)("span",{children:[t+1,". ",e.username]}),Object(d.jsx)("span",{children:e.score})]})}))]})]})]})},D=(c(56),function(){var e=Object(r.useContext)(v),t=e.gameStart,c=e.setGameStart,s=e.sensitivity,n=e.setSensitivity,a=e.fov,i=e.setFov,o=t===h;return Object(d.jsxs)("div",{id:"startOverlay",children:[Object(d.jsx)("h3",{className:"text",children:"Click the yellow circle in the center to start. Press ESC to exit."}),Object(d.jsx)("div",{id:"startButton",className:o?"disableStart":""}),!o&&Object(d.jsx)("div",{className:"clickTip",children:"Click the Yellow circle"}),o&&Object(d.jsx)("button",{className:"retryButton",onClick:function(){return c(x)},children:"Try Again?"}),Object(d.jsxs)("div",{className:"slidersWrapper",children:[Object(d.jsxs)("div",{className:"slider",children:[Object(d.jsxs)("div",{children:["Sensitivity: ",s]}),Object(d.jsx)("input",{type:"range",min:-6,max:6,value:s,onChange:function(e){return n(e.target.value)}})]}),Object(d.jsxs)("div",{className:"slider",children:[Object(d.jsxs)("div",{children:["FOV: ",a]}),Object(d.jsx)("input",{type:"range",min:40,max:100,value:a,onChange:function(e){return i(e.target.value)}})]}),Object(d.jsx)("div",{children:Object(d.jsx)("button",{onClick:function(){n(g),i(_)},children:"Reset Defaults"})})]})]})}),F=function(){var e=Object(r.useContext)(v),t=e.gameStart,c=e.setTotalClicks;return Object(d.jsxs)("div",{onClick:function(e){t===p&&c((function(e){return e+1}))},style:{height:"100vh",width:"100vw"},children:[Object(d.jsx)(I,{}),Object(d.jsx)(T,{}),Object(d.jsx)(D,{}),Object(d.jsx)(A,{})]})};c(57);function R(){return Object(d.jsx)(N,{children:Object(d.jsx)(F,{})})}var J=document.getElementById("root");a.a.render(Object(d.jsx)(r.StrictMode,{children:Object(d.jsx)(R,{})}),J)}},[[58,1,2]]]);
//# sourceMappingURL=main.fbaf7983.chunk.js.map