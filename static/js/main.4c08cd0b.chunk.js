(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{14:function(e,t,c){e.exports={gameOverlay:"GameOverlay_gameOverlay__11lfk",counter:"GameOverlay_counter__10t_X",count:"GameOverlay_count__1Jwug",finishedOverlay:"GameOverlay_finishedOverlay__3Uj9q",saveScoreForm:"GameOverlay_saveScoreForm__GTFwf",formDesc:"GameOverlay_formDesc__1NZAk",formInput:"GameOverlay_formInput__GN6kZ",error:"GameOverlay_error__CxX68",lds_dual_ring:"GameOverlay_lds_dual_ring__Z7iuB","lds-dual-ring":"GameOverlay_lds-dual-ring__1TG8e",topScorer:"GameOverlay_topScorer__1nlm3",leaderboardButton:"GameOverlay_leaderboardButton__2awEM",leaderboardModal:"GameOverlay_leaderboardModal__osw0N",closeButton:"GameOverlay_closeButton__2yy3U",leadersList:"GameOverlay_leadersList__2XUML",leadersItem:"GameOverlay_leadersItem__3UTzu"}},51:function(e,t,c){},55:function(e,t,c){},56:function(e,t,c){},57:function(e,t,c){"use strict";c.r(t);var s,r=c(7),n=c(37),a=c.n(n),i=c(20),o=c(13),l=c(15),u=c(9),j=c(60),d=c(5),b=Object(r.createContext)(),O="NOT_STARTED",m="START_TIMER",v="STARTED",f="FINISHED",x=10,p=5,h=75,S=0,y=function(e){var t=e.children,c=Object(r.useState)(60),n=Object(u.a)(c,2),a=n[0],i=n[1],o=Object(r.useState)(O),l=Object(u.a)(o,2),x=l[0],p=l[1],y=Object(r.useState)(0),_=Object(u.a)(y,2),g=_[0],N=_[1],k=Object(r.useState)(0),C=Object(u.a)(k,2),G=C[0],I=C[1],T=Object(r.useState)(0),E=Object(u.a)(T,2),w=E[0],L=E[1],M=Object(r.useState)(h),B=Object(u.a)(M,2),z=B[0],A=B[1],D=Object(r.useState)(S),F=Object(u.a)(D,2),R=F[0],J=F[1],P=Object(r.useState)(!1),U=Object(u.a)(P,2),X=U[0],Z=U[1],q=Object(r.useState)(),H=Object(u.a)(q,2),V=H[0],Y=H[1],$=function(){j.a.get("https://us-central1-gridshot-bbd16.cloudfunctions.net/getTopScores").then((function(e){e.data&&e.data.users&&Y(e.data.users)}))};return Object(r.useEffect)((function(){var e=localStorage.getItem("topScore"),t=localStorage.getItem("sensitivity"),c=localStorage.getItem("fov"),s=localStorage.getItem("scoreSaved");e&&L(JSON.parse(e)),c&&A(JSON.parse(c)),t&&J(JSON.parse(t)),s&&Z(JSON.parse(s)),$()}),[]),Object(r.useEffect)((function(){localStorage.setItem("sensitivity",R),localStorage.setItem("fov",z)}),[R,z]),Object(r.useEffect)((function(){localStorage.setItem("scoreSaved",X)}),[X]),Object(r.useEffect)((function(){x===m&&(s=setInterval((function(){i((function(e){return e>1?e-1:(clearInterval(s),p(f),0)}))}),1e3),p(v)),x===f&&clearInterval(s)}),[x]),Object(d.jsx)(b.Provider,{value:{timeLeft:a,setTimeLeft:i,score:g,setScore:N,gameStart:x,setGameStart:p,totalClicks:G,setTotalClicks:I,topScore:w,setTopScore:L,fov:z,setFov:A,sensitivity:R,setSensitivity:J,scoreSaved:X,setScoreSaved:Z,leaderboard:V,getScores:$},children:t})},_=function(e){for(var t=Math.floor(21*Math.random());e.includes(t);)t=Math.floor(21*Math.random());return t},g=function(e){var t=e.setScore,c=void 0===t?function(){}:t,s=Object(r.useState)([]),n=Object(u.a)(s,2),a=n[0],i=n[1];Object(r.useEffect)((function(){var e=[];e.push(_(e)),e.push(_(e)),e.push(_(e)),i(e)}),[]);var o=Object(r.useCallback)((function(e){var t=e.position,s=e.id;return Object(d.jsxs)("mesh",{onClick:function(e){var t=e.object.sphereId,s=_(a),r=Object(l.a)(a).filter((function(e){return e!==t}));r.push(s),i(r),c((function(e){return e+1}))},sphereId:s,position:t,children:[Object(d.jsx)("sphereGeometry",{args:[1,32,32]}),Object(d.jsx)("meshPhysicalMaterial",{color:"red"})]})}),[a]);return Object(d.jsxs)("group",{position:[0,0,-9],children:[a.includes(0)&&Object(d.jsx)(o,{id:0,position:[9,1,0]}),a.includes(1)&&Object(d.jsx)(o,{id:1,position:[6,1,0]}),a.includes(2)&&Object(d.jsx)(o,{id:2,position:[3,1,0]}),a.includes(3)&&Object(d.jsx)(o,{id:3,position:[0,1,0]}),a.includes(4)&&Object(d.jsx)(o,{id:4,position:[-3,1,0]}),a.includes(5)&&Object(d.jsx)(o,{id:5,position:[-6,1,0]}),a.includes(6)&&Object(d.jsx)(o,{id:6,position:[-9,1,0]}),a.includes(7)&&Object(d.jsx)(o,{id:7,position:[9,4,0]}),a.includes(8)&&Object(d.jsx)(o,{id:8,position:[6,4,0]}),a.includes(9)&&Object(d.jsx)(o,{id:9,position:[3,4,0]}),a.includes(10)&&Object(d.jsx)(o,{id:10,position:[0,4,0]}),a.includes(11)&&Object(d.jsx)(o,{id:11,position:[-3,4,0]}),a.includes(12)&&Object(d.jsx)(o,{id:12,position:[-6,4,0]}),a.includes(13)&&Object(d.jsx)(o,{id:13,position:[-9,4,0]}),a.includes(14)&&Object(d.jsx)(o,{id:14,position:[9,7,0]}),a.includes(15)&&Object(d.jsx)(o,{id:15,position:[6,7,0]}),a.includes(16)&&Object(d.jsx)(o,{id:16,position:[3,7,0]}),a.includes(17)&&Object(d.jsx)(o,{id:17,position:[0,7,0]}),a.includes(18)&&Object(d.jsx)(o,{id:18,position:[-3,7,0]}),a.includes(19)&&Object(d.jsx)(o,{id:19,position:[-6,7,0]}),a.includes(20)&&Object(d.jsx)(o,{id:20,position:[-9,7,0]})]})},N=(c(51),c(61)),k=[0,0,0],C=Object(r.forwardRef)((function(e,t){var c=1+.1*e.sensitivity;return Object(i.b)((function(){if(t.current.camera.fov=e.fov,t.current.camera.updateProjectionMatrix(),0===t.current.camera.rotation.x&&0===t.current.camera.rotation.y&&0===t.current.camera.rotation.z)k=[0,0,0];else{var s={x:k[0]-t.current.camera.rotation.x,y:k[1]-t.current.camera.rotation.y,z:k[2]-t.current.camera.rotation.z},r=[t.current.camera.rotation.x-s.x*c,t.current.camera.rotation.y-s.y*c,t.current.camera.rotation.z-s.z*c];t.current.camera.rotation.set(r[0],r[1],r[2]),k[0]=t.current.camera.rotation.x,k[1]=t.current.camera.rotation.y,k[2]=t.current.camera.rotation.z}})),Object(d.jsx)(N.a,{selector:"#startButton",ref:t})})),G=function(){var e=Object(r.useRef)(),t=Object(r.useContext)(b),c=t.gameStart,s=t.setGameStart,n=t.setTimeLeft,a=t.setScore,l=t.setTotalClicks,u=t.sensitivity,j=t.fov;Object(r.useEffect)((function(){}),[e]),Object(r.useEffect)((function(){c===f&&e.current.unlock()}),[c]);return Object(d.jsxs)(i.a,{onCreated:function(t){var c=document.querySelector("#cursor"),r=document.querySelector("#startOverlay");e.current.addEventListener("lock",(function(){document.body.style.cursor="none",c.style.display="initial",r.style.display="none",n(60),s(m),a(0),l(0)})),e.current.addEventListener("unlock",(function(){document.body.style.cursor="initial",c.style.display="none",r.style.display="block",e.current&&e.current.camera&&e.current.camera.rotation.set(0,0,0),s(f)})),e.current.addEventListener("change",(function(t){var c=new o.Vector3;e.current.getDirection(c)}))},children:[Object(d.jsx)("pointLight",{castShadow:!0,color:"#fff",position:[0,4,10],intensity:2}),Object(d.jsx)("ambientLight",{intensity:1}),Object(d.jsx)(g,{setScore:a}),Object(d.jsxs)("mesh",{scale:[20,10,18],position:[0,4,0],children:[Object(d.jsx)("boxGeometry",{}),Object(d.jsx)("meshPhysicalMaterial",{metalness:.7,roughness:2,color:"#fff",side:o.DoubleSide})]}),Object(d.jsx)(C,{fov:j,sensitivity:u,ref:e})]})},I=function(){var e=Object(r.useRef)(),t=function(t){e.current&&(e.current.style.left="".concat(t.clientX,"px"),e.current.style.top="".concat(t.clientY,"px"))};return Object(r.useEffect)((function(){return document.body.addEventListener("mousemove",t),function(){return document.body.removeEventListener("mousemove",t)}}),[]),Object(d.jsx)("span",{ref:e,id:"cursor",className:"cursor"})},T=c(17),E=c.n(T),w=c(34),L=c(14),M=c.n(L),B=/^(?=[a-zA-Z0-9._]{3,20}$)(?!.*[_.]{2})[^_.].*[^_.]$/,z=function(){var e=Object(r.useContext)(b),t=e.timeLeft,c=e.score,s=e.totalClicks,n=e.gameStart,a=e.topScore,i=e.setTopScore,o=e.scoreSaved,l=e.setScoreSaved,m=e.leaderboard,v=e.getScores,h=Object(r.useState)(""),S=Object(u.a)(h,2),y=S[0],_=S[1],g=Object(r.useState)(""),N=Object(u.a)(g,2),k=N[0],C=N[1],G=Object(r.useState)(!1),I=Object(u.a)(G,2),T=I[0],L=I[1],z=Object(r.useState)(!1),A=Object(u.a)(z,2),D=A[0],F=A[1],R=function(){return c*x-(s-c)*p},J=n===f||n===O,P=R(),U=s-c,X=(c/s*100).toFixed(2),Z=n===f&&!o&&a,q=m&&m[0];Object(r.useEffect)((function(){if(n===f){var e=R();e>a&&(i(e),l(!1),localStorage.setItem("topScore",e))}}),[n]);var H=function(){var e=Object(w.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k&&B.test(k)){e.next=4;break}_("Please enter a valid username. Alpha-numeric between 3-20 characters"),e.next=17;break;case 4:return e.prev=4,L(!0),e.next=8,j.a.post("https://us-central1-gridshot-bbd16.cloudfunctions.net/addScore",{user:{username:k,score:Number(a)}});case 8:t=e.sent,L(!1),200===t.status&&(l(!0),v()),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(4),L(!1),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{class:M.a.gameOverlay,children:[Object(d.jsxs)("div",{className:M.a.counter,children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{style:{fontSize:"20px"},children:"Time left:"}),Object(d.jsx)("span",{style:{color:"red"},className:M.a.count,children:t})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{children:"Current score:"}),Object(d.jsx)("span",{className:M.a.count,children:P})]})]}),q&&Object(d.jsxs)("div",{className:M.a.topScorer,children:[Object(d.jsx)("div",{children:"Top Scorer"}),Object(d.jsxs)("div",{children:[q.username," : ",q.score]}),Object(d.jsx)("div",{className:M.a.leaderboardButton,onClick:function(){return F(!0)},children:"See leaderboard"})]}),J&&Object(d.jsxs)("div",{className:M.a.finishedOverlay,children:[Object(d.jsxs)("span",{children:["Score: ",P]}),Object(d.jsxs)("span",{children:["Hits: ",c]}),Object(d.jsxs)("span",{children:["Total Clicks: ",s]}),Object(d.jsxs)("span",{children:["Misses: ",U]}),Object(d.jsxs)("span",{children:["Accuracy: ",isNaN(X)?"N/A":"".concat(X,"%")]}),Object(d.jsxs)("span",{children:["Best Score: ",a]})]}),Z&&Object(d.jsxs)("div",{className:M.a.saveScoreForm,children:[Object(d.jsx)("span",{className:M.a.formDesc,children:"Save your top score on the leaderboards."}),Object(d.jsxs)("span",{className:M.a.formInput,children:["Enter name:"," ",Object(d.jsx)("input",{type:"text",value:k,onChange:function(e){C(e.target.value)}}),T&&Object(d.jsx)("div",{className:M.a.lds_dual_ring})]}),Object(d.jsx)("span",{className:M.a.error,style:{display:y?"inline":"none"},children:y}),Object(d.jsx)("button",{disabled:T,onClick:H,children:"Submit"})]}),D&&Object(d.jsxs)("div",{className:M.a.leaderboardModal,children:[Object(d.jsx)("div",{className:M.a.closeButton,onClick:function(){return F(!1)},children:"close"}),Object(d.jsxs)("div",{className:M.a.leadersList,children:[Object(d.jsxs)("div",{className:M.a.leadersItem,children:[Object(d.jsx)("span",{children:"Name"}),Object(d.jsx)("span",{children:"Score"})]}),m&&m.map((function(e,t){return Object(d.jsxs)("div",{className:M.a.leadersItem,children:[Object(d.jsxs)("span",{children:[t+1,". ",e.username]}),Object(d.jsx)("span",{children:e.score})]})}))]})]})]})},A=(c(55),function(){var e=Object(r.useContext)(b),t=e.gameStart,c=e.setGameStart,s=e.sensitivity,n=e.setSensitivity,a=e.fov,i=e.setFov,o=t===f;return Object(d.jsxs)("div",{id:"startOverlay",children:[Object(d.jsx)("h3",{className:"text",children:"Click the yellow circle in the center to start. Press ESC to exit."}),Object(d.jsx)("div",{id:"startButton",className:o?"disableStart":""}),!o&&Object(d.jsx)("div",{className:"clickTip",children:"Click the Yellow circle"}),o&&Object(d.jsx)("button",{className:"retryButton",onClick:function(){return c(O)},children:"Try Again?"}),Object(d.jsxs)("div",{className:"slidersWrapper",children:[Object(d.jsxs)("div",{className:"slider",children:[Object(d.jsxs)("div",{children:["Sensitivity: ",s]}),Object(d.jsx)("input",{type:"range",min:-6,max:6,value:s,onChange:function(e){return n(e.target.value)}})]}),Object(d.jsxs)("div",{className:"slider",children:[Object(d.jsxs)("div",{children:["FOV: ",a]}),Object(d.jsx)("input",{type:"range",min:40,max:100,value:a,onChange:function(e){return i(e.target.value)}})]}),Object(d.jsx)("div",{children:Object(d.jsx)("button",{onClick:function(){n(S),i(h)},children:"Reset Defaults"})})]})]})}),D=function(){var e=Object(r.useContext)(b),t=e.gameStart,c=e.setTotalClicks;return Object(d.jsxs)("div",{onClick:function(e){t===v&&c((function(e){return e+1}))},style:{height:"100vh",width:"100vw"},children:[Object(d.jsx)(G,{}),Object(d.jsx)(I,{}),Object(d.jsx)(A,{}),Object(d.jsx)(z,{})]})};c(56);function F(){return Object(d.jsx)(y,{children:Object(d.jsx)(D,{})})}var R=document.getElementById("root");a.a.render(Object(d.jsx)(r.StrictMode,{children:Object(d.jsx)(F,{})}),R)}},[[57,1,2]]]);
//# sourceMappingURL=main.4c08cd0b.chunk.js.map